'use strict';Object.defineProperty(exports,'__esModule',{value:true});exports.CLIEngine=CLIEngine;var _commander=require('commander');var _commander2=_interopRequireDefault(_commander);var _commands=require('./commands');var _commands2=_interopRequireDefault(_commands);var _reporter=require('../reporter');var _rearVersion=require('../rear-version');var _rearVersion2=_interopRequireDefault(_rearVersion);var _printHelpFooter=require('./utils/print-help-footer');var _printHelpFooter2=_interopRequireDefault(_printHelpFooter);function _interopRequireDefault(obj){return obj&&obj.__esModule?obj:{default:obj}}async function CLIEngine(args){const doubleDashIndex=args.findIndex(element=>element==='--');const startArgs=args.slice(0,2);args=args.slice(2,doubleDashIndex===-1?args.length:doubleDashIndex);const endArgs=doubleDashIndex===-1?[]:args.slice(doubleDashIndex);_commander2.default.usage('[cmd] [options]');_commander2.default.version(`rear@v${_rearVersion2.default}`);_commander2.default.on('--help',printHelp);_commander2.default.parse([...startArgs,...args,...endArgs]);let command;let commandName=args.shift()||'help';if(commandName==='-v'||commandName==='--version'){_reporter.Reporter.log(`rear@v${_rearVersion2.default}`);return Promise.resolve()}if(commandName==='--help'||commandName==='-h'){commandName='help'}if(commandName[0]==='-'){args.unshift(commandName);commandName='install'}if(_commands2.default.has(commandName)){command=_commands2.default.get(commandName)}else if(args.length>=0){args.unshift(commandName);commandName='run';command=_commands2.default.get(commandName)}if(!command||commandName==='help'&&args.length===0){_commander2.default.outputHelp();return Promise.resolve()}return await command.run(args)}function printHelp(){_reporter.Reporter.log();_reporter.Reporter.highlight('  Commands: ');_reporter.Reporter.log();let longestCmd=0;let cmds=[];var _iteratorNormalCompletion=true;var _didIteratorError=false;var _iteratorError=undefined;try{for(var _iterator=_commands.CommandList[Symbol.iterator](),_step;!(_iteratorNormalCompletion=(_step=_iterator.next()).done);_iteratorNormalCompletion=true){const cmd=_step.value;if(cmd.hidden)continue;if(longestCmd<cmd.usage.length)longestCmd=cmd.usage.length;cmds.push(cmd)}}catch(err){_didIteratorError=true;_iteratorError=err}finally{try{if(!_iteratorNormalCompletion&&_iterator.return){_iterator.return()}}finally{if(_didIteratorError){throw _iteratorError}}}var _iteratorNormalCompletion2=true;var _didIteratorError2=false;var _iteratorError2=undefined;try{for(var _iterator2=cmds[Symbol.iterator](),_step2;!(_iteratorNormalCompletion2=(_step2=_iterator2.next()).done);_iteratorNormalCompletion2=true){const cmd=_step2.value;let pad=longestCmd-cmd.usage.length+1;do{cmd.usage+=' ';pad--}while(pad>=0);_reporter.Reporter.log(`    %c${cmd.usage}%c${cmd.description}`,'cyan','reset')}}catch(err){_didIteratorError2=true;_iteratorError2=err}finally{try{if(!_iteratorNormalCompletion2&&_iterator2.return){_iterator2.return()}}finally{if(_didIteratorError2){throw _iteratorError2}}}(0,_printHelpFooter2.default)(_reporter.Reporter)}